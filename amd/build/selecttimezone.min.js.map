{"version":3,"sources":["../src/selecttimezone.js"],"names":["define","$","Repository","CustomEvents","SELECTORS","SETTIMEZONE","SETTIMEZONE_MODAL","SETTIMEZONE_SELECTOR","SETTIMEZONE_SUCCESS","USERMENU","registerEventListeners","root","events","activate","on","e","data","timezonemodal","find","modal","originalEvent","preventDefault","change","selected","val","setTimeZone","timezone","then","result","success","removeClass","html","time","init","actionitem","newitem","clone","addClass","after","attr"],"mappings":"AAuBAA,OAAM,kCACN,CACI,QADJ,CAEI,4BAFJ,CAGI,gCAHJ,CADM,CAMN,SACIC,CADJ,CAEIC,CAFJ,CAGIC,CAHJ,CAIE,IAEMC,CAAAA,CAAS,CAAG,CACZC,WAAW,CAAE,gCADD,CAEZC,iBAAiB,CAAE,kCAFP,CAGZC,oBAAoB,CAAE,qCAHV,CAIZC,mBAAmB,CAAE,0CAJT,CAKZC,QAAQ,CAAE,2DALE,CAFlB,CAeMC,CAAsB,CAAG,SAASC,CAAT,CAAe,CACxCR,CAAY,CAACH,MAAb,CAAoBW,CAApB,CAA0B,CACtBR,CAAY,CAACS,MAAb,CAAoBC,QADE,CAA1B,EAIAF,CAAI,CAACG,EAAL,CAAQX,CAAY,CAACS,MAAb,CAAoBC,QAA5B,CAAsCT,CAAS,CAACC,WAAhD,CAA6D,SAASU,CAAT,CAAYC,CAAZ,CAAkB,CAC3E,GAAIC,CAAAA,CAAa,CAAGN,CAAI,CAACO,IAAL,CAAUd,CAAS,CAACE,iBAApB,CAApB,CACAW,CAAa,CAACE,KAAd,CAAoB,MAApB,EACAH,CAAI,CAACI,aAAL,CAAmBC,cAAnB,EACH,CAJD,EAMApB,CAAC,CAACG,CAAS,CAACG,oBAAX,CAAD,CAAkCe,MAAlC,CAAyC,UAAW,CAChD,GAAIC,CAAAA,CAAQ,CAAGtB,CAAC,CAAC,IAAD,CAAD,CAAQuB,GAAR,EAAf,CACAtB,CAAU,CAACuB,WAAX,CAAuB,CACnBC,QAAQ,CAAEH,CADS,CAAvB,EAEGI,IAFH,CAEQ,SAASC,CAAT,CAAiB,CACrB,GAAsB,CAAlB,EAAAA,CAAM,CAACC,OAAX,CAAyB,CACrBlB,CAAI,CAACO,IAAL,CAAUd,CAAS,CAACI,mBAApB,EAAyCsB,WAAzC,CAAqD,QAArD,CACH,CACD7B,CAAC,CAACG,CAAS,CAACC,WAAX,CAAD,CAAyB0B,IAAzB,CAA8BH,CAAM,CAACI,IAArC,CACH,CAPD,CAQH,CAVD,CAWH,CArCH,CA0DE,MAAO,CACHC,IAAI,CAfG,QAAPA,CAAAA,IAAO,CAAStB,CAAT,CAAe,CACtBA,CAAI,CAAGV,CAAC,CAACU,CAAD,CAAR,CADsB,GAGlBuB,CAAAA,CAAU,CAAGvB,CAAI,CAACO,IAAL,CAAUd,CAAS,CAACC,WAApB,CAHK,CAIlB8B,CAAO,CAAGD,CAAU,CAACE,KAAX,EAJQ,CAKtBD,CAAO,CAACL,WAAR,GAAsBO,QAAtB,CAA+B,uCAA/B,EACA1B,CAAI,CAACO,IAAL,CAAUd,CAAS,CAACK,QAApB,EAA8B6B,KAA9B,CAAoCH,CAApC,EAEA,GAAI,CAACxB,CAAI,CAAC4B,IAAL,CAAU,WAAV,CAAL,CAA6B,CACzB7B,CAAsB,CAACC,CAAD,CAAtB,CACAA,CAAI,CAAC4B,IAAL,CAAU,WAAV,IACH,CACJ,CAEM,CAGV,CAvEK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Select the Arup timezone\n *\n * @package    theme_nova\n * @copyright  2019 Bas Brands <bas@sonsbeekmedia.nl>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(\n[\n    'jquery',\n    'theme_arupboost/repository',\n    'core/custom_interaction_events'\n],\nfunction(\n    $,\n    Repository,\n    CustomEvents\n) {\n\n    var SELECTORS = {\n        SETTIMEZONE: '[data-action=\"set-timezone\"]',\n        SETTIMEZONE_MODAL: '[data-region=\"timezone-modal\"]',\n        SETTIMEZONE_SELECTOR: '[data-region=\"timezone-selector\"]',\n        SETTIMEZONE_SUCCESS: '[data-region=\"updatetimezone-success\"]',\n        USERMENU: '.usermenu .dropdown-menu a[data-title=\"profile,moodle\"]'\n    };\n\n    /**\n     * Listen to, and handle events for the arupboost theme\n     *\n     * @param {Object} root The event nodes container element.\n     */\n    var registerEventListeners = function(root) {\n        CustomEvents.define(root, [\n            CustomEvents.events.activate\n        ]);\n\n        root.on(CustomEvents.events.activate, SELECTORS.SETTIMEZONE, function(e, data) {\n            var timezonemodal = root.find(SELECTORS.SETTIMEZONE_MODAL);\n            timezonemodal.modal('show');\n            data.originalEvent.preventDefault();\n        });\n\n        $(SELECTORS.SETTIMEZONE_SELECTOR).change(function() {\n            var selected = $(this).val();\n            Repository.setTimeZone({\n                timezone: selected\n            }).then(function(result) {\n                if (result.success == 1) {\n                    root.find(SELECTORS.SETTIMEZONE_SUCCESS).removeClass('hidden');\n                }\n                $(SELECTORS.SETTIMEZONE).html(result.time);\n            });\n        });\n    };\n\n    /**\n     * Intialise the timezone selector.\n     *\n     * @param {object} root The root element containing the timezone modal.\n     */\n    var init = function(root) {\n        root = $(root);\n\n        var actionitem = root.find(SELECTORS.SETTIMEZONE);\n        var newitem = actionitem.clone();\n        newitem.removeClass().addClass('dropdown-item menu-action setusertime');\n        root.find(SELECTORS.USERMENU).after(newitem);\n\n        if (!root.attr('data-init')) {\n            registerEventListeners(root);\n            root.attr('data-init', true);\n        }\n    };\n\n    return {\n        init: init\n    };\n});"],"file":"selecttimezone.min.js"}